rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Configs: read/write owner only
    // Security: Prevents unauthorized config access and modifications
    // Note: Participants access configs via API endpoints (which use Admin SDK) or static files, not directly from Firestore
    match /configs/{configId} {
      allow read: if request.auth != null && resource.data.owner == request.auth.uid;
      // Security: Only allow writes if authenticated and owner matches
      // Supports both create (request.resource) and update (resource) operations
      allow create: if request.auth != null && 
                      request.resource.data.owner == request.auth.uid;
      allow update, delete: if request.auth != null && 
                              resource.data.owner == request.auth.uid;
    }
    
    // Sessions: open for now (participant auth in future PR)
    // Security: Will be protected in future PR with session ownership validation
    match /sessions/{sessionId} {
      allow read, write: if true;
    }
    
    // Events: open for now (participant auth in future PR)
    // Security: Will be protected in future PR with session ownership validation
    match /events/{eventId} {
      allow read, write: if true;
    }
  }
}
